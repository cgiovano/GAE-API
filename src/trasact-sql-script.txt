CREATE TABLE turma (
	id INTEGER IDENTITY(1,1) PRIMARY KEY,
	identificacao VARCHAR(25) NOT NULL, 
	ano INTEGER NOT NULL
);

CREATE TABLE aluno (
	id INTEGER IDENTITY(1,1) PRIMARY KEY,
	id_turma INTEGER,
	CONSTRAINT turma_fk FOREIGN KEY(id_turma) REFERENCES turma(id) ON UPDATE CASCADE ON DELETE NO ACTION,
	nome VARCHAR(100) NOT NULL
);

CREATE TABLE atividade (
	id INTEGER IDENTITY(1,1) PRIMARY KEY, 
	descricao VARCHAR(1256),
	data_inicio DATE NOT NULL, 
	data_fim DATE NOT NULL, 
	nota FLOAT NOT NULL
);

CREATE TABLE criterio (
	id INTEGER IDENTITY(1,1) PRIMARY KEY,
	descricao VARCHAR(256) NOT NULL, 
	pontuacao FLOAT NOT NULL
);

CREATE TABLE item_criterio (
	id INTEGER IDENTITY(1,1) PRIMARY KEY, 
	id_criterio INTEGER, 
	CONSTRAINT criterio_fk FOREIGN KEY (id_criterio) REFERENCES criterio(id) ON UPDATE CASCADE ON DELETE NO ACTION,
	descricao VARCHAR(256) NOT NULL,
	pontuacao FLOAT NOT NULL
);

CREATE TABLE questao (
	id INTEGER IDENTITY(1,1) PRIMARY KEY, 
	id_atividade INTEGER, 
	CONSTRAINT atividade_fk FOREIGN KEY(id_atividade) REFERENCES atividade(id) ON UPDATE CASCADE ON DELETE NO ACTION,
	descricao VARCHAR(256) NOT NULL, 
	pontuacao FLOAT NOT NULL
);

CREATE TABLE correcao (
	id INTEGER IDENTITY(1,1) PRIMARY KEY, 
	id_aluno INTEGER, 
	CONSTRAINT aluno_fk FOREIGN KEY(id_aluno) REFERENCES aluno(id) ON UPDATE CASCADE ON DELETE NO ACTION,  
	id_atividade INTEGER, 
	CONSTRAINT atividade_fk FOREIGN KEY(id_atividade) REFERENCES atividade(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	pontuacao FLOAT
);

CREATE TABLE correcao_questao (
	id INTEGER IDENTITY(1,1) PRIMARY KEY, 
	id_correcao INTEGER, 
	CONSTRAINT correcao_fk FOREIGN KEY(id_correcao) REFERENCES correcao(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	id_questao INTEGER, 
	CONSTRAINT questao_fk FOREIGN KEY(id_questao) REFERENCES questao(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	id_criterio INTEGER, 
	CONSTRAINT criterio_fk FOREIGN KEY(id_criterio) REFERENCES criterio(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	id_item_criterio INTEGER, 
	CONSTRAINT item_criterio_fk FOREIGN KEY(id_item_criterio) REFERENCES item_criterio(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	pontuacao FLOAT, 
	descricao_correcao VARCHAR(512) 
);

-- TABELAS DE PONTE/MULTIPLOS RELACIONAMENTO ENTRE TABELAS

CREATE TABLE lista_atividade (
	id_aluno INTEGER, 
	CONSTRAINT aluno_fk FOREIGN KEY(id_aluno) REFERENCES aluno(id), 
	id_atividade INTEGER,
	CONSTRAINT atividade_fk FOREIGN KEY(id_atividade) REFERENCES atividade(id) ON UPDATE CASCADE ON DELETE NO ACTION
);

CREATE TABLE criterio_questao (
	id_criterio INTEGER, 
	CONSTRAINT criterio_fk FOREIGN KEY(id_criterio) REFERENCES criterio(id) ON UPDATE CASCADE ON DELETE NO ACTION, 
	id_questao INTEGER, 
	CONSTRAINT questao_fk FOREIGN KEY(id_questao) REFERENCES questao(id) ON UPDATE CASCADE ON DELETE NO ACTION
);